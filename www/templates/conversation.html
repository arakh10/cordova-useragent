<ion-view>
    <ion-nav-title translate translate-values="{name: conversation.withUser.nickName}">Conversation with %s</ion-nav-title>
    <ion-content>
        <ul class="list chat">
            <li
                class="message"
                ng-repeat="message in messages"
                ng-class="{'item-positive': message.isNew, mine: message.id == currUser.id, failed: message.error ? true : false}"
                ng-click="resend($index)">

                <span ng-bind-html="message.text | linky:'_blank' | emoticonize"></span>

                <div class="status">
                    <span ng-if="message.error" translate>Failed. Tap to retry.</span>
                    <span ng-if="!message.error">
                        <span ng-if="!message.dateSent" translate>Sending..</span>
                        <span ng-if="message.dateSent">{{message.dateSent*1000 | amCalendar}}</span>
                    </span>
                </div>
            </li>
        </ul>
        <div class="center center-vertical-margin">
            <ion-spinner ng-show="!messages.$resolved"></ion-spinner>
            <div class="error-sign" ng-if="messages.$resolved && messages.length < 1">
                <div translate>None yet</div>
                <span translate>Send a message. Get to know each other</span>
                <i class="icon ion-ios-rainy"></i>
            </div>
        </div>
    </ion-content>

    <ion-footer-bar keyboard-attach class="bar-stable">
        <form class="item-input-inset" ng-submit="sendMessage()" style="width: 100%">
            <label class="item-input-wrapper">
                <input
                        type="text"
                        placeholder="{{'Your message' | translate}}"
                        ng-model="msgText" />
            </label>
            <button class="button button-clear" type="submit" ng-disabled="msgText.length < 1" translate>
                Send
            </button>
        </form>
    </ion-footer-bar>
</ion-view>